# mvgrpfiles

A Python program that moves all files from all members of a group to an archive.

## Installation

The program can be installed as a Debian package. The following commands can be used to build the `.deb` file:

    sudo apt install python3-all dh-python
    pip install stdeb
    python setup.py --command-packages=stdeb.command sdist_dsc
    cd deb_dist/mvgrpfiles-1.0.8
    dpkg-buildpackage

## Usage

The program can be executed using the `mvgrpfiles` command. It requires a group name as only parameter:

    mvgrpfiles GROUP_NAME

The program validates there is exactly one input parameter. It also checks the parameter is a group that exists in the system.

If the program is already running for the same group, it cannot be executed. If the program is running for a different group, it is checked that both groups do not share any users before executing. The program performs these validations using lock files which are stored in `/var/tmp/mvgrpfiles/locks`. Every time the program runs, it creates a lock file named after the group passed as parameter. When the program exits, the lock file is removed.

The logs generated by the program are stored in `.mvgrpfiles/logs/`, in the home of the user executing it.

The script traverses the whole file system looking for all files owned by the members of the group (not just the files owned by the group itself). If a permission error is encountered, the program notifies the user, logs the issue, and continues.

Once it has found all the files, the program archives them in a `.tar` file, owned by the user executing the program. The archive file is stored in `.mvgrpfile/archive`, in the home of the user executing the script. Each file is removed right after being archived. If a permission error is encountered, it means some files will be archived but not be removed from their original locations. They are, again, notified and logged.

## Enhancements

The following features could be implemented to improve the program:

- Let the user choose where to store the archives
- Use compression to store the archives
- Let the user choose where to search for files
- Restore the files if the program is stopped during the archiving step
